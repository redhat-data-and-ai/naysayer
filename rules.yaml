# Rule-Based Validation Configuration

enabled: true

files:
  # Product configs - section-based validation with strategic auto-approvals
  - name: "product_configs"
    path: "**/"
    filename: "product.{yaml,yml}"
    parser_type: yaml
    sections:
      # Critical sections - manual review required
      - name: warehouses
        yaml_path: warehouses
        rule_names: [warehouse_rule]
        auto_approve: false
      - name: dbt
        yaml_path: service_account.dbt
        rule_names: [metadata_rule]
        auto_approve: false
      
      # Low-risk sections - auto-approve after validation
      - name: description
        yaml_path: description
        rule_names: [metadata_rule]
        auto_approve: true
      
      # Safe sections - immediate auto-approval
      - name: documentation_url
        yaml_path: documentation.url
        auto_approve: true
      - name: changelog
        yaml_path: changelog
        auto_approve: true

  # Simple file types - leverage auto-approve for low-risk files
  - name: "documentation_files"
    path: "**/"
    filename: "*.md"
    parser_type: markdown
    sections:
      - name: full_file
        yaml_path: .
        auto_approve: true

  # Service accounts - split complex pattern for clarity
  - name: "astro_service_accounts"
    path: "**/"
    filename: "*_astro_*_appuser.{yaml,yml}"
    parser_type: yaml
    sections:
      - name: serviceaccount
        yaml_path: .
        rule_names: [service_account_rule]
        auto_approve: true
        
  - name: "other_service_accounts"
    path: "**/"
    filename: "*serviceaccount*.{yaml,yml}"
    parser_type: yaml
    sections:
      - name: serviceaccount
        yaml_path: .
        rule_names: [service_account_rule]
        auto_approve: false

  - name: "yaml_metadata_files"
    path: "**/"
    filename: "developers.{yaml,yml}"
    parser_type: yaml
    sections:
      - name: full_file
        yaml_path: .
        rule_names: [metadata_rule]
        auto_approve: true

require_full_coverage: false
manual_review_on_uncovered: true