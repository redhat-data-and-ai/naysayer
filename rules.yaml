# Rule-Based Validation Configuration for dataproduct-config repository

enabled: true

files:
  # Product configuration files - Critical infrastructure validation
  - name: "product_configs"
    path: "**/dataproducts/**/"
    filename: "product.{yaml,yml}"
    parser_type: yaml
    enabled: true
    sections:
      # Critical sections - always require manual review
      - name: warehouses
        yaml_path: warehouses
        rule_configs:
          - name: warehouse_rule
            enabled: true
        auto_approve: false
      
      - name: service_account
        yaml_path: service_account
        rule_configs:
          - name: metadata_rule
            enabled: true
        auto_approve: false
      
      # Safe sections - can auto-approve after validation
      - name: name
        yaml_path: name
        rule_configs:
          - name: metadata_rule
            enabled: true
        auto_approve: true

      - name: rover_group
        yaml_path: rover_group
        rule_configs:
          - name: metadata_rule
            enabled: true
        auto_approve: true

      - name: tags
        yaml_path: tags
        rule_configs:
          - name: metadata_rule
            enabled: true
        auto_approve: true

  # Developer metadata files - Low risk, can auto-approve
  - name: "developer_metadata"
    path: "**/dataproducts/**/"
    filename: "developers.{yaml,yml}"
    parser_type: yaml
    enabled: true
    sections:
      - name: full_file
        yaml_path: .
        rule_configs:
          - name: metadata_rule
            enabled: true
        auto_approve: true

# STRICT POLICY ENFORCEMENT:
# Any file type not explicitly configured above will require manual review by default.
# This includes:
#   - .sql files (migration scripts) - CRITICAL: Always require manual review
#   - .md files (documentation) - Should be reviewed
#   - .gitlab-ci.yml (CI configuration) - Security-critical
#   - .yaml/.yml files not matching patterns above - Require review
#   - Any other file types - Default to manual review
#
# This implements the strict policy: "do not approve if MR has changes not covered in rules"